@startuml
title Multi-Zone Parking Detection System - Architecture

actor "User" as user

package "Input Data" {
  folder "data/grid_photos/" as grid
  folder "data/inputs/" as inputs
  note right of grid : Reference images
  note right of inputs : Detection images
}

package "Core Components" {
  component "Main Pipeline\n(main.py)" as main
  component "Zone Editor\n(edit_parking_zones.py)" as mapping
  component "Utilities\n(parking_utils.py)" as utils
  component "Vehicle Detector\n(vehicle_detector.py)" as detection
}

package "Configuration" {
  database "Zone Map\n(parking_map.json)" as map_json
  database "Zone Visualization\n(zones_visualization.png)" as map_img
}

package "Output Results" {
  database "Detection Log\n(occupancy_log.csv)" as csv_log
  database "Detection Summary\n(occupancy_summary.json)" as json_out
  database "Result Images" as vis_imgs
}

package "External Tools" {
  component "YOLOv8" as model
  component "OpenCV" as opencv
}

' Main workflow
user --> main : execute system
main --> detection : normal mode (default)
main --> mapping : editor mode (--edit)

' Zone creation
grid --> mapping : create zones
mapping --> map_json : save zones
mapping --> map_img : save visualization

' Detection process
inputs --> detection : process images
map_json --> detection : load zones
detection --> csv_log : save results
detection --> json_out : save summary
detection --> vis_imgs : save images

' Utilities
utils --> mapping : support functions
utils --> detection : support functions

' External dependencies
model --> detection : vehicle detection
opencv --> detection : image processing
opencv --> mapping : zone editing

@enduml